<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typeahead + Search Flow Diagrams</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            font-size: 2.5em;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 25px;
            background: #e2e8f0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab.active {
            background: #6366f1;
            color: white;
        }

        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .diagram-container {
            display: none;
            margin-top: 30px;
        }

        .diagram-container.active {
            display: block;
        }

        svg {
            width: 100%;
            height: auto;
        }

        .flow-arrow {
            animation: dash 20s linear infinite;
        }

        @keyframes dash {
            to {
                stroke-dashoffset: -1000;
            }
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 10px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 2px solid #cbd5e0;
        }

        .metrics-panel {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #fef3c7 0%, #fde047 100%);
            border-radius: 15px;
            border: 2px solid #fbbf24;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #6366f1;
        }

        .metric-value {
            font-size: 1.8em;
            font-weight: 700;
            color: #6366f1;
        }

        .metric-label {
            font-size: 0.9em;
            color: #4a5568;
            margin-top: 5px;
        }

        .flow-description {
            background: #e0e7ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #6366f1;
        }

        .flow-description h3 {
            color: #4338ca;
            margin-bottom: 10px;
        }

        .flow-description ol {
            margin-left: 20px;
            line-height: 2;
            color: #1e293b;
        }

        .flow-description ol li {
            margin: 8px 0;
        }

        .flow-description strong {
            color: #6366f1;
        }

        .flow-description ul {
            margin-left: 20px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üîç Typeahead + Search Flow Diagrams</h1>
        <p style="color: #64748b; margin-top: 10px;">Interactive Request Flow Visualization</p>

        <div class="tabs">
            <button class="tab active" onclick="showDiagram('typeahead')">‚ö° Typeahead Flow</button>
            <button class="tab" onclick="showDiagram('search')">üîé Search Flow</button>
            <button class="tab" onclick="showDiagram('indexing')">üì• Indexing Flow</button>
            <button class="tab" onclick="showDiagram('full')">üèóÔ∏è Full System</button>
        </div>
    </div>

    <!-- Typeahead Flow Diagram -->
    <div id="typeahead-diagram" class="diagram-container active">
        <svg viewBox="0 0 1400 1200" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6366f1" />
                </marker>
                <linearGradient id="grad-client" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="grad-lb" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#818cf8;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#6366f1;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="grad-service" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#facc15;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#eab308;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="grad-redis" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#f472b6;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="grad-trie" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#fef08a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#fde047;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="grad-es" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#86efac;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#22c55e;stop-opacity:1" />
                </linearGradient>
            </defs>

            <!-- Title -->
            <text x="700" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#2d3748">
                Typeahead Flow: Real-Time Query Suggestions
            </text>

            <!-- Client -->
            <g class="component">
                <rect x="600" y="70" width="200" height="80" rx="10" fill="url(#grad-client)" stroke="#2563eb" stroke-width="2"/>
                <text x="700" y="105" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üë§ Client</text>
                <text x="700" y="125" font-size="12" text-anchor="middle" fill="white">User types "sea..."</text>
            </g>

            <path d="M 700 150 L 700 190" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>
            <text x="720" y="175" font-size="11" fill="#4338ca" font-weight="600">GET /typeahead?q=sea</text>

            <!-- Load Balancer -->
            <g class="component">
                <rect x="600" y="190" width="200" height="80" rx="10" fill="url(#grad-lb)" stroke="#4f46e5" stroke-width="2"/>
                <text x="700" y="225" font-size="16" font-weight="bold" text-anchor="middle" fill="white">‚öñÔ∏è Load Balancer</text>
                <text x="700" y="245" font-size="12" text-anchor="middle" fill="white">+ API Gateway</text>
            </g>

            <path d="M 700 270 L 700 310" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>
            <text x="720" y="295" font-size="11" fill="#4338ca" font-weight="600">Route to service</text>

            <!-- Typeahead Service -->
            <g class="component">
                <rect x="550" y="310" width="300" height="100" rx="10" fill="url(#grad-service)" stroke="#ca8a04" stroke-width="2"/>
                <text x="700" y="345" font-size="16" font-weight="bold" text-anchor="middle" fill="white">‚ö° Typeahead Service</text>
                <text x="700" y="365" font-size="12" text-anchor="middle" fill="white">Autocomplete Engine</text>
                <text x="700" y="385" font-size="11" text-anchor="middle" fill="white">Latency Budget: 50ms</text>
            </g>

            <!-- Decision Diamond -->
            <g class="component">
                <path d="M 700 450 L 800 510 L 700 570 L 600 510 Z" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                <text x="700" y="505" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">Redis</text>
                <text x="700" y="523" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">Cache?</text>
            </g>

            <!-- Cache Hit Path (Right) -->
            <path d="M 800 510 L 1000 510" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
            <text x="870" y="500" font-size="12" fill="#059669" font-weight="700">HIT ‚úì (85%)</text>

            <g class="component">
                <rect x="1000" y="460" width="200" height="100" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="3"/>
                <text x="1100" y="495" font-size="14" font-weight="bold" text-anchor="middle" fill="#065f46">‚úÖ Return from Cache</text>
                <text x="1100" y="515" font-size="12" text-anchor="middle" fill="#065f46">Latency: ~5ms</text>
                <text x="1100" y="535" font-size="11" text-anchor="middle" fill="#065f46">Top 10 suggestions</text>
            </g>

            <path d="M 1100 460 L 1100 150 L 800 150" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="8,4"/>
            <text x="1120" y="300" font-size="12" fill="#059669" font-weight="700">Fast Path</text>

            <!-- Cache Miss Path -->
            <path d="M 700 570 L 700 630" stroke="#ef4444" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
            <text x="620" y="605" font-size="12" fill="#dc2626" font-weight="700">MISS ‚úó (15%)</text>

            <!-- Trie Lookup -->
            <g class="component">
                <rect x="550" y="630" width="300" height="100" rx="10" fill="url(#grad-trie)" stroke="#ca8a04" stroke-width="2"/>
                <text x="700" y="665" font-size="16" font-weight="bold" text-anchor="middle" fill="#854d0e">üå≤ Trie Lookup</text>
                <text x="700" y="685" font-size="12" text-anchor="middle" fill="#854d0e">In-Memory Prefix Tree</text>
                <text x="700" y="705" font-size="11" text-anchor="middle" fill="#854d0e">O(k) lookup, k=prefix length</text>
            </g>

            <!-- Trie Decision -->
            <g class="component">
                <path d="M 700 770 L 800 830 L 700 890 L 600 830 Z" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                <text x="700" y="825" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">In Trie?</text>
            </g>

            <!-- Trie Hit -->
            <path d="M 800 830 L 950 830" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
            <text x="850" y="820" font-size="12" fill="#059669" font-weight="700">YES ‚úì</text>

            <g class="component">
                <rect x="950" y="780" width="180" height="100" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="3"/>
                <text x="1040" y="815" font-size="14" font-weight="bold" text-anchor="middle" fill="#065f46">‚úÖ Return</text>
                <text x="1040" y="835" font-size="11" text-anchor="middle" fill="#065f46">Latency: ~15ms</text>
                <text x="1040" y="855" font-size="11" text-anchor="middle" fill="#065f46">+ Cache update</text>
            </g>

            <path d="M 1040 780 L 1040 560 L 1000 560" stroke="#10b981" stroke-width="3" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>

            <!-- Trie Miss ‚Üí Elasticsearch -->
            <path d="M 700 890 L 700 950" stroke="#ef4444" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
            <text x="620" y="925" font-size="12" fill="#dc2626" font-weight="700">NO ‚úó (rare)</text>

            <!-- Elasticsearch -->
            <g class="component">
                <rect x="550" y="950" width="300" height="100" rx="10" fill="url(#grad-es)" stroke="#16a34a" stroke-width="2"/>
                <text x="700" y="985" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üîç Elasticsearch</text>
                <text x="700" y="1005" font-size="12" text-anchor="middle" fill="white">Prefix Query (long-tail)</text>
                <text x="700" y="1025" font-size="11" text-anchor="middle" fill="white">Latency: ~50ms</text>
            </g>

            <path d="M 850 1000 L 950 880" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
            <text x="880" y="940" font-size="10" fill="#4338ca">Update cache</text>

            <!-- Response Path -->
            <path d="M 550 680 L 300 680 L 300 230 L 600 230" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="8,4"/>
            <text x="250" y="450" font-size="12" fill="#059669" font-weight="700">‚Üê Response</text>
            <text x="250" y="470" font-size="11" fill="#059669">200 OK</text>

            <!-- Step Numbers -->
            <circle cx="700" cy="110" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="117" font-size="14" font-weight="bold" text-anchor="middle" fill="white">1</text>

            <circle cx="700" cy="230" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="237" font-size="14" font-weight="bold" text-anchor="middle" fill="white">2</text>

            <circle cx="700" cy="360" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="367" font-size="14" font-weight="bold" text-anchor="middle" fill="white">3</text>

            <circle cx="700" cy="680" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="687" font-size="14" font-weight="bold" text-anchor="middle" fill="white">4</text>

            <circle cx="700" cy="1000" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="1007" font-size="14" font-weight="bold" text-anchor="middle" fill="white">5</text>
        </svg>

        <div class="flow-description">
            <h3>‚ö° Typeahead Flow Steps</h3>
            <ol>
                <li><strong>Client Request:</strong> User types "sea" ‚Üí Client debounces (300ms) ‚Üí Sends GET /typeahead?q=sea&limit=10</li>
                <li><strong>Load Balancer:</strong> Routes to healthy Typeahead Service instance (Round Robin)</li>
                <li><strong>Typeahead Service:</strong>
                    <ul>
                        <li>Receives request, starts latency timer</li>
                        <li>Normalizes query (lowercase, trim)</li>
                        <li>Checks Redis cache first</li>
                    </ul>
                </li>
                <li><strong>Cache Check:</strong>
                    <ul>
                        <li><strong>HIT (85%):</strong> Return cached suggestions in ~5ms ‚úÖ</li>
                        <li><strong>MISS (15%):</strong> Proceed to Trie lookup ‚Üì</li>
                    </ul>
                </li>
                <li><strong>Trie Lookup:</strong>
                    <ul>
                        <li>Traverse Trie from root to "sea" node</li>
                        <li>Retrieve pre-computed top-10 suggestions</li>
                        <li>If prefix not in Trie ‚Üí Query Elasticsearch (long-tail queries)</li>
                        <li>Update Redis cache for future requests</li>
                    </ul>
                </li>
                <li><strong>Response:</strong> Return JSON with suggestions, sorted by frequency/relevance</li>
            </ol>
            <div style="margin-top: 15px; padding: 15px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 5px;">
                <strong>üéØ Performance:</strong> P95 latency <50ms, cache hit rate 85%, handles 100K QPS peak!
            </div>
        </div>
    </div>

    <!-- Search Flow Diagram -->
    <div id="search-diagram" class="diagram-container">
        <svg viewBox="0 0 1400 1300" xmlns="http://www.w3.org/2000/svg">
            <!-- Title -->
            <text x="700" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#2d3748">
                Search Flow: Full-Text Search with Ranking
            </text>

            <!-- Client -->
            <g class="component">
                <rect x="600" y="70" width="200" height="80" rx="10" fill="url(#grad-client)" stroke="#2563eb" stroke-width="2"/>
                <text x="700" y="105" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üë§ Client</text>
                <text x="700" y="125" font-size="12" text-anchor="middle" fill="white">Submit query</text>
            </g>

            <path d="M 700 150 L 700 190" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>
            <text x="720" y="175" font-size="11" fill="#4338ca" font-weight="600">POST /search</text>

            <!-- Load Balancer -->
            <g class="component">
                <rect x="600" y="190" width="200" height="80" rx="10" fill="url(#grad-lb)" stroke="#4f46e5" stroke-width="2"/>
                <text x="700" y="225" font-size="16" font-weight="bold" text-anchor="middle" fill="white">‚öñÔ∏è Load Balancer</text>
                <text x="700" y="245" font-size="12" text-anchor="middle" fill="white">Auth + Rate Limit</text>
            </g>

            <path d="M 700 270 L 700 310" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Search Service -->
            <g class="component">
                <rect x="550" y="310" width="300" height="100" rx="10" fill="url(#grad-es)" stroke="#16a34a" stroke-width="2"/>
                <text x="700" y="345" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üîé Search Service</text>
                <text x="700" y="365" font-size="12" text-anchor="middle" fill="white">Query Processing</text>
                <text x="700" y="385" font-size="11" text-anchor="middle" fill="white">Rewriting ‚Ä¢ Normalization</text>
            </g>

            <path d="M 700 410 L 700 450" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Cache Decision -->
            <g class="component">
                <path d="M 700 490 L 800 550 L 700 610 L 600 550 Z" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                <text x="700" y="545" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">Cache?</text>
            </g>

            <!-- Cache Hit -->
            <path d="M 800 550 L 1000 550" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
            <text x="870" y="540" font-size="12" fill="#059669" font-weight="700">HIT ‚úì (20%)</text>

            <g class="component">
                <rect x="1000" y="500" width="200" height="100" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="3"/>
                <text x="1100" y="535" font-size="14" font-weight="bold" text-anchor="middle" fill="#065f46">‚úÖ Cached Results</text>
                <text x="1100" y="555" font-size="11" text-anchor="middle" fill="#065f46">Latency: ~20ms</text>
            </g>

            <path d="M 1100 500 L 1100 230 L 800 230" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="8,4"/>

            <!-- Cache Miss ‚Üí ES -->
            <path d="M 700 610 L 700 670" stroke="#ef4444" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
            <text x="620" y="645" font-size="12" fill="#dc2626" font-weight="700">MISS ‚úó (80%)</text>

            <!-- Elasticsearch Query -->
            <g class="component">
                <rect x="550" y="670" width="300" height="120" rx="10" fill="url(#grad-es)" stroke="#16a34a" stroke-width="2"/>
                <text x="700" y="710" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üîç Elasticsearch</text>
                <text x="700" y="730" font-size="12" text-anchor="middle" fill="white">Multi-Match Query</text>
                <text x="700" y="750" font-size="11" text-anchor="middle" fill="white">‚Ä¢ BM25 Scoring</text>
                <text x="700" y="768" font-size="11" text-anchor="middle" fill="white">‚Ä¢ Field Boosting (title^3)</text>
            </g>

            <path d="M 700 790 L 700 850" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Ranking Service -->
            <g class="component">
                <rect x="550" y="850" width="300" height="120" rx="10" fill="#fed7aa" stroke="#ea580c" stroke-width="2"/>
                <text x="700" y="890" font-size="16" font-weight="bold" text-anchor="middle" fill="#9a3412">üéØ Ranking Service</text>
                <text x="700" y="910" font-size="12" text-anchor="middle" fill="#9a3412">ML Re-ranking</text>
                <text x="700" y="930" font-size="11" text-anchor="middle" fill="#9a3412">‚Ä¢ Personalization</text>
                <text x="700" y="948" font-size="11" text-anchor="middle" fill="#9a3412">‚Ä¢ Popularity boost</text>
            </g>

            <path d="M 700 970 L 700 1030" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Post-Processing -->
            <g class="component">
                <rect x="550" y="1030" width="300" height="100" rx="10" fill="url(#grad-service)" stroke="#ca8a04" stroke-width="2"/>
                <text x="700" y="1065" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üìù Post-Processing</text>
                <text x="700" y="1085" font-size="11" text-anchor="middle" fill="white">‚Ä¢ Snippet generation</text>
                <text x="700" y="1103" font-size="11" text-anchor="middle" fill="white">‚Ä¢ Highlighting</text>
            </g>

            <!-- Update Cache -->
            <path d="M 850 1080 L 1000 600" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="3,3"/>
            <text x="900" y="850" font-size="10" fill="#4338ca">Update cache</text>

            <!-- Response -->
            <path d="M 550 1080 L 300 1080 L 300 230 L 600 230" stroke="#10b981" stroke-width="4" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="8,4"/>
            <text x="250" y="650" font-size="12" fill="#059669" font-weight="700">‚Üê Response</text>
            <text x="250" y="670" font-size="11" fill="#059669">200 OK</text>

            <!-- Step Numbers -->
            <circle cx="700" cy="110" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="117" font-size="14" font-weight="bold" text-anchor="middle" fill="white">1</text>

            <circle cx="700" cy="360" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="367" font-size="14" font-weight="bold" text-anchor="middle" fill="white">2</text>

            <circle cx="700" cy="730" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="737" font-size="14" font-weight="bold" text-anchor="middle" fill="white">3</text>

            <circle cx="700" cy="910" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="917" font-size="14" font-weight="bold" text-anchor="middle" fill="white">4</text>

            <circle cx="700" cy="1080" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="1087" font-size="14" font-weight="bold" text-anchor="middle" fill="white">5</text>
        </svg>

        <div class="flow-description">
            <h3>üîé Search Flow Steps</h3>
            <ol>
                <li><strong>Client Request:</strong> User submits "machine learning courses" ‚Üí POST /search with filters</li>
                <li><strong>Search Service - Query Processing:</strong>
                    <ul>
                        <li>Spell correction (if needed)</li>
                        <li>Synonym expansion ("ML" ‚Üí "machine learning")</li>
                        <li>Stop word analysis</li>
                        <li>Generate cache key (hash of query + filters)</li>
                        <li>Check Redis cache (20% hit rate for search)</li>
                    </ul>
                </li>
                <li><strong>Elasticsearch Query:</strong>
                    <ul>
                        <li>Multi-match query across fields (title^3, content, tags^2)</li>
                        <li>Apply filters (category, date range)</li>
                        <li>BM25 scoring for text relevance</li>
                        <li>Fuzzy matching for typo tolerance</li>
                        <li>Return top 100 candidates</li>
                    </ul>
                </li>
                <li><strong>ML Ranking Service:</strong>
                    <ul>
                        <li>Apply LambdaMART model (Learning-to-Rank)</li>
                        <li>Personalization boost (user profile matching)</li>
                        <li>Popularity signal (CTR, engagement)</li>
                        <li>Recency boost for fresh content</li>
                        <li>Quality score (authority, completeness)</li>
                        <li>Re-rank top 100 ‚Üí top 20 results</li>
                    </ul>
                </li>
                <li><strong>Post-Processing:</strong>
                    <ul>
                        <li>Generate snippets with query highlighting</li>
                        <li>Compute facets/aggregations</li>
                        <li>Apply business rules (deduplication, diversity)</li>
                        <li>Cache result (TTL: 5 minutes)</li>
                    </ul>
                </li>
                <li><strong>Response:</strong> Return JSON with results, facets, metadata (total_hits, took_ms)</li>
                <li><strong>Async:</strong> Log query to Kafka for analytics (CTR tracking, model training)</li>
            </ol>
            <div style="margin-top: 15px; padding: 15px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 5px;">
                <strong>üéØ Performance:</strong> P95 latency <200ms, handles 10K QPS, NDCG@10 > 0.85
            </div>
        </div>
    </div>

    <!-- Indexing Flow Diagram -->
    <div id="indexing-diagram" class="diagram-container">
        <svg viewBox="0 0 1400 1100" xmlns="http://www.w3.org/2000/svg">
            <!-- Title -->
            <text x="700" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#2d3748">
                Indexing Flow: Real-Time Document Ingestion
            </text>

            <!-- Data Source -->
            <g class="component">
                <rect x="600" y="70" width="200" height="80" rx="10" fill="#bfdbfe" stroke="#2563eb" stroke-width="2"/>
                <text x="700" y="105" font-size="16" font-weight="bold" text-anchor="middle" fill="#1e40af">üìÑ Data Source</text>
                <text x="700" y="125" font-size="12" text-anchor="middle" fill="#1e40af">New/Updated Doc</text>
            </g>

            <path d="M 700 150 L 700 190" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>
            <text x="720" y="175" font-size="11" fill="#4338ca" font-weight="600">Publish event</text>

            <!-- Kafka -->
            <g class="component">
                <rect x="550" y="190" width="300" height="100" rx="10" fill="#fca5a5" stroke="#ef4444" stroke-width="2"/>
                <text x="700" y="225" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üì¨ Kafka Queue</text>
                <text x="700" y="245" font-size="12" text-anchor="middle" fill="white">Topic: documents.new</text>
                <text x="700" y="265" font-size="11" text-anchor="middle" fill="white">Buffering ‚Ä¢ Fault Tolerance</text>
            </g>

            <path d="M 700 290 L 700 330" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>
            <text x="720" y="315" font-size="11" fill="#4338ca" font-weight="600">Consume batch</text>

            <!-- Indexing Service -->
            <g class="component">
                <rect x="550" y="330" width="300" height="120" rx="10" fill="#99f6e4" stroke="#2dd4bf" stroke-width="2"/>
                <text x="700" y="370" font-size="16" font-weight="bold" text-anchor="middle" fill="#134e4a">üîÑ Indexing Service</text>
                <text x="700" y="390" font-size="12" text-anchor="middle" fill="#134e4a">Apache Beam / Spark</text>
                <text x="700" y="410" font-size="11" text-anchor="middle" fill="#134e4a">‚Ä¢ Text extraction</text>
                <text x="700" y="428" font-size="11" text-anchor="middle" fill="#134e4a">‚Ä¢ Tokenization</text>
            </g>

            <path d="M 700 450 L 700 510" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Enrichment -->
            <g class="component">
                <rect x="550" y="510" width="300" height="120" rx="10" fill="#fde047" stroke="#eab308" stroke-width="2"/>
                <text x="700" y="550" font-size="16" font-weight="bold" text-anchor="middle" fill="#713f12">‚ú® Enrichment</text>
                <text x="700" y="570" font-size="11" text-anchor="middle" fill="#713f12">‚Ä¢ NER (entities)</text>
                <text x="700" y="588" font-size="11" text-anchor="middle" fill="#713f12">‚Ä¢ Category classification</text>
                <text x="700" y="606" font-size="11" text-anchor="middle" fill="#713f12">‚Ä¢ BERT embeddings</text>
            </g>

            <path d="M 700 630 L 700 690" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Bulk Index -->
            <g class="component">
                <rect x="550" y="690" width="300" height="100" rx="10" fill="url(#grad-es)" stroke="#16a34a" stroke-width="2"/>
                <text x="700" y="725" font-size="16" font-weight="bold" text-anchor="middle" fill="white">üîç Elasticsearch</text>
                <text x="700" y="745" font-size="12" text-anchor="middle" fill="white">Bulk Index (1000 docs)</text>
                <text x="700" y="765" font-size="11" text-anchor="middle" fill="white">Refresh interval: 5s</text>
            </g>

            <path d="M 700 790 L 700 850" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrowhead)" class="flow-arrow" stroke-dasharray="5,5"/>

            <!-- Trie Update (Async) -->
            <path d="M 850 390 L 1000 390" stroke="#9333ea" stroke-width="3" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="3,3"/>
            <text x="900" y="380" font-size="10" fill="#9333ea">Async update</text>

            <g class="component">
                <rect x="1000" y="340" width="200" height="100" rx="10" fill="#fef08a" stroke="#eab308" stroke-width="2"/>
                <text x="1100" y="375" font-size="14" font-weight="bold" text-anchor="middle" fill="#713f12">üå≤ Trie Update</text>
                <text x="1100" y="395" font-size="11" text-anchor="middle" fill="#713f12">Batch rebuild</text>
                <text x="1100" y="413" font-size="11" text-anchor="middle" fill="#713f12">Hourly schedule</text>
            </g>

            <!-- Success -->
            <g class="component">
                <rect x="550" y="850" width="300" height="80" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="3"/>
                <text x="700" y="885" font-size="16" font-weight="bold" text-anchor="middle" fill="#065f46">‚úÖ Indexed</text>
                <text x="700" y="905" font-size="12" text-anchor="middle" fill="#065f46">Searchable in <5 min</text>
            </g>

            <!-- Step Numbers -->
            <circle cx="700" cy="110" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="117" font-size="14" font-weight="bold" text-anchor="middle" fill="white">1</text>

            <circle cx="700" cy="240" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="247" font-size="14" font-weight="bold" text-anchor="middle" fill="white">2</text>

            <circle cx="700" cy="390" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="397" font-size="14" font-weight="bold" text-anchor="middle" fill="white">3</text>

            <circle cx="700" cy="570" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="577" font-size="14" font-weight="bold" text-anchor="middle" fill="white">4</text>

            <circle cx="700" cy="740" r="18" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
            <text x="700" y="747" font-size="14" font-weight="bold" text-anchor="middle" fill="white">5</text>
        </svg>

        <div class="flow-description">
            <h3>üì• Indexing Flow Steps</h3>
            <ol>
                <li><strong>Data Source:</strong> New document published (blog post, product, web page)</li>
                <li><strong>Kafka Queue:</strong>
                    <ul>
                        <li>Publishes to "documents.new" topic</li>
                        <li>Provides buffering and fault tolerance</li>
                        <li>Enables replay in case of failures</li>
                    </ul>
                </li>
                <li><strong>Indexing Service (Batch Processing):</strong>
                    <ul>
                        <li>Consumes documents in batches (1000 docs)</li>
                        <li>Text extraction from HTML/PDF/etc.</li>
                        <li>Tokenization and normalization</li>
                        <li>Language detection</li>
                        <li>Duplicate detection (hash-based)</li>
                    </ul>
                </li>
                <li><strong>Enrichment Pipeline:</strong>
                    <ul>
                        <li>Named Entity Recognition (people, places, orgs)</li>
                        <li>Category/topic classification (ML model)</li>
                        <li>Generate BERT embeddings (semantic search)</li>
                        <li>Calculate popularity score (initial estimate)</li>
                        <li>Extract metadata (author, publish date)</li>
                    </ul>
                </li>
                <li><strong>Bulk Indexing to Elasticsearch:</strong>
                    <ul>
                        <li>Batch index (1000 docs at a time for efficiency)</li>
                        <li>Elasticsearch refresh interval: 5 seconds</li>
                        <li>Documents become searchable after refresh</li>
                        <li>Total latency: <5 minutes from publish to searchable</li>
                    </ul>
                </li>
                <li><strong>Async Updates:</strong>
                    <ul>
                        <li>Trie rebuild: Hourly batch job</li>
                        <li>Query popularity updates from analytics</li>
                        <li>ML model retraining: Daily/weekly</li>
                    </ul>
                </li>
            </ol>
            <div style="margin-top: 15px; padding: 15px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 5px;">
                <strong>üéØ Performance:</strong> 50K docs/sec indexing rate, <5 min latency to searchable, 99.9% success rate
            </div>
        </div>
    </div>

    <!-- Full System Diagram -->
    <div id="full-diagram" class="diagram-container">
        <svg viewBox="0 0 1600 1200" xmlns="http://www.w3.org/2000/svg">
            <!-- Title -->
            <text x="800" y="35" font-size="28" font-weight="bold" text-anchor="middle" fill="#2d3748">
                Complete Typeahead + Search System Architecture
            </text>

            <!-- Layer Labels -->
            <text x="50" y="100" font-size="14" font-weight="bold" fill="#64748b">CLIENT</text>
            <text x="50" y="230" font-size="14" font-weight="bold" fill="#64748b">EDGE</text>
            <text x="50" y="350" font-size="14" font-weight="bold" fill="#64748b">GATEWAY</text>
            <text x="50" y="500" font-size="14" font-weight="bold" fill="#64748b">SERVICES</text>
            <text x="50" y="800" font-size="14" font-weight="bold" fill="#64748b">DATA</text>
            <text x="50" y="1050" font-size="14" font-weight="bold" fill="#64748b">ANALYTICS</text>

            <!-- Dividers -->
            <line x1="200" y1="180" x2="1550" y2="180" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="10,5"/>
            <line x1="200" y1="310" x2="1550" y2="310" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="10,5"/>
            <line x1="200" y1="450" x2="1550" y2="450" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="10,5"/>
            <line x1="200" y1="750" x2="1550" y2="750" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="10,5"/>
            <line x1="200" y1="1000" x2="1550" y2="1000" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="10,5"/>

            <!-- CLIENT LAYER -->
            <g class="component">
                <rect x="350" y="70" width="150" height="70" rx="10" fill="url(#grad-client)" stroke="#2563eb" stroke-width="2"/>
                <text x="425" y="105" font-size="13" font-weight="bold" text-anchor="middle" fill="white">üíª Web</text>
            </g>
            <g class="component">
                <rect x="550" y="70" width="150" height="70" rx="10" fill="url(#grad-client)" stroke="#2563eb" stroke-width="2"/>
                <text x="625" y="105" font-size="13" font-weight="bold" text-anchor="middle" fill="white">üì± Mobile</text>
            </g>

            <!-- EDGE LAYER -->
            <g class="component">
                <rect x="300" y="210" width="180" height="70" rx="10" fill="#a5f3fc" stroke="#0891b2" stroke-width="2"/>
                <text x="390" y="250" font-size="12" font-weight="bold" text-anchor="middle" fill="#134e4a">‚ö° CDN/WAF</text>
            </g>
            <g class="component">
                <rect x="520" y="210" width="180" height="70" rx="10" fill="#fde047" stroke="#eab308" stroke-width="2"/>
                <text x="610" y="250" font-size="12" font-weight="bold" text-anchor="middle" fill="#713f12">üåê DNS</text>
            </g>

            <!-- GATEWAY -->
            <g class="component">
                <rect x="350" y="340" width="300" height="80" rx="10" fill="url(#grad-lb)" stroke="#4f46e5" stroke-width="2"/>
                <text x="500" y="375" font-size="14" font-weight="bold" text-anchor="middle" fill="white">‚öñÔ∏è LB + API Gateway</text>
                <text x="500" y="395" font-size="10" text-anchor="middle" fill="white">Auth ‚Ä¢ Rate Limit ‚Ä¢ Routing</text>
            </g>

            <!-- SERVICES -->
            <g class="component">
                <rect x="250" y="480" width="150" height="80" rx="10" fill="url(#grad-service)" stroke="#ca8a04" stroke-width="2"/>
                <text x="325" y="515" font-size="12" font-weight="bold" text-anchor="middle" fill="white">‚ö° Typeahead</text>
                <text x="325" y="535" font-size="9" text-anchor="middle" fill="white">100K QPS</text>
            </g>
            <g class="component">
                <rect x="430" y="480" width="150" height="80" rx="10" fill="url(#grad-es)" stroke="#16a34a" stroke-width="2"/>
                <text x="505" y="515" font-size="12" font-weight="bold" text-anchor="middle" fill="white">üîé Search</text>
                <text x="505" y="535" font-size="9" text-anchor="middle" fill="white">10K QPS</text>
            </g>
            <g class="component">
                <rect x="610" y="480" width="150" height="80" rx="10" fill="#99f6e4" stroke="#2dd4bf" stroke-width="2"/>
                <text x="685" y="515" font-size="12" font-weight="bold" text-anchor="middle" fill="white">üîÑ Indexing</text>
            </g>

            <!-- Supporting -->
            <g class="component">
                <rect x="250" y="600" width="130" height="60" rx="8" fill="#fed7aa" stroke="#ea580c" stroke-width="2"/>
                <text x="315" y="635" font-size="11" font-weight="bold" text-anchor="middle" fill="#9a3412">üéØ Ranking</text>
            </g>

            <!-- Message Queue -->
            <g class="component">
                <rect x="250" y="690" width="510" height="40" rx="8" fill="#fca5a5" stroke="#ef4444" stroke-width="2"/>
                <text x="505" y="715" font-size="11" font-weight="bold" text-anchor="middle" fill="white">üì¨ Kafka</text>
            </g>

            <!-- DATA LAYER -->
            <g class="component">
                <rect x="250" y="780" width="150" height="90" rx="10" fill="#fef08a" stroke="#eab308" stroke-width="2"/>
                <text x="325" y="820" font-size="12" font-weight="bold" text-anchor="middle" fill="#713f12">üå≤ Trie</text>
                <text x="325" y="840" font-size="9" text-anchor="middle" fill="#713f12">45 GB</text>
            </g>
            <g class="component">
                <rect x="430" y="780" width="150" height="90" rx="10" fill="url(#grad-redis)" stroke="#db2777" stroke-width="2"/>
                <text x="505" y="820" font-size="12" font-weight="bold" text-anchor="middle" fill="white">üíæ Redis</text>
                <text x="505" y="840" font-size="9" text-anchor="middle" fill="white">100 GB</text>
            </g>
            <g class="component">
                <rect x="610" y="780" width="150" height="90" rx="10" fill="url(#grad-es)" stroke="#16a34a" stroke-width="2"/>
                <text x="685" y="820" font-size="12" font-weight="bold" text-anchor="middle" fill="white">üîç Elasticsearch</text>
                <text x="685" y="840" font-size="9" text-anchor="middle" fill="white">270 TB</text>
            </g>

            <!-- ANALYTICS -->
            <g class="component">
                <rect x="250" y="1030" width="200" height="80" rx="10" fill="#e9d5ff" stroke="#c084fc" stroke-width="2"/>
                <text x="350" y="1065" font-size="12" font-weight="bold" text-anchor="middle" fill="#6b21a8">üìä ClickHouse</text>
                <text x="350" y="1085" font-size="9" text-anchor="middle" fill="#6b21a8">Query Logs</text>
            </g>
            <g class="component">
                <rect x="480" y="1030" width="150" height="80" rx="10" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                <text x="555" y="1065" font-size="11" font-weight="bold" text-anchor="middle" fill="#92400e">üìà Grafana</text>
            </g>

            <!-- MONITORING (Right side) -->
            <g class="component">
                <rect x="1200" y="480" width="280" height="100" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
                <text x="1340" y="520" font-size="13" font-weight="bold" text-anchor="middle" fill="#065f46">üìà MONITORING</text>
                <text x="1340" y="540" font-size="10" text-anchor="middle" fill="#065f46">Prometheus ‚Ä¢ Grafana</text>
                <text x="1340" y="556" font-size="10" text-anchor="middle" fill="#065f46">ELK ‚Ä¢ Jaeger</text>
            </g>

            <!-- Arrows -->
            <path d="M 425 140 L 425 210" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
            <path d="M 500 280 L 500 340" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
            <path d="M 500 420 L 325 480" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
            <path d="M 500 420 L 505 480" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
            <path d="M 325 560 L 325 780" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
            <path d="M 505 560 L 505 780" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
            <path d="M 505 690 L 505 730" stroke="#9333ea" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="3,3"/>
            <path d="M 505 730 L 350 1030" stroke="#9333ea" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="3,3"/>
        </svg>

        <div class="flow-description">
            <h3>üèóÔ∏è Full System Overview</h3>
            <p style="margin-bottom: 15px; line-height: 1.8;">
                Complete architecture showing all components working together:
            </p>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px;">
                <div style="background: #f0f9ff; padding: 15px; border-radius: 10px; border-left: 4px solid #0284c7;">
                    <h4 style="color: #075985; margin-bottom: 8px;">‚ö° Typeahead Path</h4>
                    <p style="font-size: 0.9em; color: #0c4a6e; line-height: 1.6;">
                        Client ‚Üí CDN ‚Üí LB ‚Üí Typeahead Service ‚Üí Trie/Redis ‚Üí Response (15-50ms)
                    </p>
                </div>
                <div style="background: #f0fdf4; padding: 15px; border-radius: 10px; border-left: 4px solid #10b981;">
                    <h4 style="color: #065f46; margin-bottom: 8px;">üîé Search Path</h4>
                    <p style="font-size: 0.9em; color: #064e3b; line-height: 1.6;">
                        Client ‚Üí CDN ‚Üí LB ‚Üí Search Service ‚Üí ES + Ranking ‚Üí Response (120-200ms)
                    </p>
                </div>
                <div style="background: #fefce8; padding: 15px; border-radius: 10px; border-left: 4px solid #ca8a04;">
                    <h4 style="color: #713f12; margin-bottom: 8px;">üì• Indexing Path</h4>
                    <p style="font-size: 0.9em; color: #713f12; line-height: 1.6;">
                        Source ‚Üí Kafka ‚Üí Indexing Service ‚Üí ES + Trie Update (<5 min)
                    </p>
                </div>
                <div style="background: #fdf4ff; padding: 15px; border-radius: 10px; border-left: 4px solid #c084fc;">
                    <h4 style="color: #6b21a8; margin-bottom: 8px;">üìä Analytics Path</h4>
                    <p style="font-size: 0.9em; color: #6b21a8; line-height: 1.6;">
                        Query ‚Üí Kafka ‚Üí ClickHouse ‚Üí Dashboards (async)
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Metrics Panel -->
    <div class="metrics-panel">
        <h2 style="margin-bottom: 15px; color: #92400e;">‚ö° System Performance Metrics</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value">100K</div>
                <div class="metric-label">Typeahead QPS</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">10K</div>
                <div class="metric-label">Search QPS</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">15ms</div>
                <div class="metric-label">Typeahead P50</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">120ms</div>
                <div class="metric-label">Search P50</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">85%</div>
                <div class="metric-label">Cache Hit Rate</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">99.9%</div>
                <div class="metric-label">Availability</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">10B</div>
                <div class="metric-label">Documents Indexed</div>
            </div>
            <div class="metric-card">
                <div class="metric-value"><5min</div>
                <div class="metric-label">Index Latency</div>
            </div>
        </div>
    </div>

    <!-- Legend -->
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #60a5fa, #3b82f6);"></div>
            <span>Client</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #facc15, #eab308);"></div>
            <span>Typeahead</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #86efac, #22c55e);"></div>
            <span>Search</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #f472b6, #ec4899);"></div>
            <span>Cache</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #c084fc, #a855f7);"></div>
            <span>Analytics</span>
        </div>
    </div>
</div>

<script>
    function showDiagram(type) {
        // Hide all diagrams
        document.querySelectorAll('.diagram-container').forEach(d => {
            d.classList.remove('active');
        });

        // Remove active from all tabs
        document.querySelectorAll('.tab').forEach(t => {
            t.classList.remove('active');
        });

        // Show selected diagram
        document.getElementById(type + '-diagram').classList.add('active');

        // Activate clicked tab
        event.target.classList.add('active');
    }

    // Add hover effects
    document.querySelectorAll('.component').forEach(comp => {
        comp.addEventListener('mouseenter', function() {
            this.style.filter = 'drop-shadow(0 0 15px rgba(99, 102, 241, 0.6))';
        });

        comp.addEventListener('mouseleave', function() {
            this.style.filter = 'none';
        });
    });
</script>
</body>
</html>
